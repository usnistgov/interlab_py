
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Outlier Detection: Refit to single population &#8212; interlab 0.1.1 documentation</title>
    <link rel="stylesheet" href="_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="https://pages.nist.gov/nist-header-footer/css/nist-combined.css" />
    <link rel="stylesheet" type="text/css" href="https://pages.nist.gov/leaveNotice/css/jquery.leaveNotice.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script type="text/javascript" src="https://pages.nist.gov/nist-header-footer/js/jquery-1.9.0.min.js"></script>
    <script type="text/javascript" src="https://pages.nist.gov/nist-header-footer/js/nist-header-footer.js"></script>
    <script id="_fed_an_ua_tag" type="text/javascript" src="https://dap.digitalgov.gov/Universal-Federated-Analytics-Min.js?agency=NIST&subagency=github&pua=UA-42404149-54&yt=true&exts=ppsx,pps,f90,sch,rtf,wrl,txz,m1v,xlsm,msi,xsd,f,tif,eps,mpg,xml,pl,xlt,c"></script>
    <script type="text/javascript" src="https://code.jquery.com/jquery.1.12.4.min.js"></script>
    <script type="text/javascript" src="https://pages.nist.gov/leaveNotice/js/jquery.leaveNotice-nist.min.js"></script>
    <script type="text/javascript" src="_static/leave_notice.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Outlier Detection: Recursive" href="mAb_outlier_detection_recursive.html" /> 
  </head><body>
    <div class="header-wrapper" role="banner">
      <div class="header">
        <div class="headertitle"><a
          href="index.html">interlab 0.1.1 documentation</a></div>
        <div class="rel" role="navigation" aria-label="related navigation">
          <a href="mAb_outlier_detection_recursive.html" title="Outlier Detection: Recursive"
             accesskey="P">previous</a> |
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 4ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="section" id="Outlier-Detection:-Refit-to-single-population">
<h1>Outlier Detection: Refit to single population<a class="headerlink" href="#Outlier-Detection:-Refit-to-single-population" title="Permalink to this headline">¶</a></h1>
<div class="section" id="Imports">
<h2>Imports<a class="headerlink" href="#Imports" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#Python modules for numerics and scientific computing</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="c1">#scikit-learn</span>
<span class="kn">import</span> <span class="nn">sklearn.preprocessing</span> <span class="k">as</span> <span class="nn">skpp</span>
<span class="kn">import</span> <span class="nn">sklearn.decomposition</span> <span class="k">as</span> <span class="nn">skdecomp</span>

<span class="c1">#Matplotlib</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.colors</span> <span class="k">as</span> <span class="nn">mcolors</span>
<span class="kn">import</span> <span class="nn">matplotlib.lines</span> <span class="k">as</span> <span class="nn">mlines</span>
<span class="kn">import</span> <span class="nn">matplotlib.patches</span> <span class="k">as</span> <span class="nn">mpatches</span>

<span class="kn">import</span> <span class="nn">mab_utils</span>
<span class="kn">import</span> <span class="nn">plot_utils</span> <span class="k">as</span> <span class="nn">plu</span>
<span class="c1">#import tqdm</span>

<span class="kn">import</span> <span class="nn">interlab</span> <span class="k">as</span> <span class="nn">inl</span>
<span class="kn">import</span> <span class="nn">interlab.utilities</span>
<span class="kn">import</span> <span class="nn">pickle</span>
</pre></div>
</div>
</div>
<p>Load data from processing notebook</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">jeffries</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;Symmetric Kullback-Liebler&#39;</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;mAb_interlab_project.sav&#39;</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">mab_project</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;mab_analysis_accessories.sav&#39;</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="p">(</span><span class="n">windowed_shape</span><span class="p">,</span><span class="n">jeffries</span><span class="p">,</span><span class="n">full_indices</span><span class="p">,</span><span class="n">split_point</span><span class="p">,</span>
     <span class="n">ssi_contours</span><span class="p">,</span><span class="n">interp_map</span><span class="p">)</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

<span class="n">metadata_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_hdf</span><span class="p">(</span><span class="s1">&#39;metadata_table_raw.h5&#39;</span><span class="p">,</span><span class="n">key</span><span class="o">=</span><span class="s1">&#39;NMR_2D_raw&#39;</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Calculate-probability-scores-and-find-outliers">
<h2>Calculate probability scores and find outliers<a class="headerlink" href="#Calculate-probability-scores-and-find-outliers" title="Permalink to this headline">¶</a></h2>
<p>The matrix of pairwise distances is collapsed into the vector of average distances by taking the average distance of each spectrum from each other. The population of average distances in each group is fit to a distribution (here, lognormal).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">mab_project</span><span class="o">.</span><span class="n">fit_zscores</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Probability scores are calculated for each measurement within each group and spectra outside the 95 % confidence boundary are identified as outliers.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">mab_project</span><span class="o">.</span><span class="n">find_outliers</span><span class="p">(</span><span class="n">recursive</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">support_fraction</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">mab_utils</span><span class="o">.</span><span class="n">save_outlier_data</span><span class="p">(</span><span class="n">metadata_table</span><span class="p">,</span><span class="n">mab_project</span><span class="p">,</span><span class="n">full_indices</span><span class="p">,</span>
                                        <span class="n">split_point</span><span class="p">,</span><span class="n">metric</span><span class="o">=</span><span class="n">jeffries</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The entire set of Z-scores is then used as a single population and a new distribution is fit.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">normalized_scores</span> <span class="o">=</span> <span class="n">metadata_table</span><span class="o">.</span><span class="n">Zscore</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">new_pop</span> <span class="o">=</span> <span class="n">inl</span><span class="o">.</span><span class="n">utilities</span><span class="o">.</span><span class="n">Population</span><span class="p">(</span><span class="s1">&#39;All spectra normalized&#39;</span><span class="p">,</span>
                                  <span class="n">distribution</span><span class="o">=</span><span class="n">sp</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">lognorm</span><span class="p">,</span>
                                   <span class="n">values</span><span class="o">=</span><span class="n">normalized_scores</span>
                                  <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">new_pop</span><span class="o">.</span><span class="n">fit_zscores</span><span class="p">()</span>
<span class="n">new_pop</span><span class="o">.</span><span class="n">find_outliers</span><span class="p">()</span>
<span class="n">f</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">new_pop</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">num_bins</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
<span class="n">t</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Sample logarithmic Z score, $Z_{i,k}$&quot;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">t</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Probability Density&quot;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="n">caption_text</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Histogram of the within-group logarithmic Z scores&#39;</span> <span class="o">+</span>
                <span class="s1">&#39;plotted with the corresponding lognormal distribution. </span><span class="se">\n</span><span class="s1">The 95% &#39;</span> <span class="o">+</span>
                <span class="s1">&#39;confidence boundary is shown as a vertical dashed line. &#39;</span>
               <span class="p">)</span>

<span class="n">width</span><span class="p">,</span><span class="n">height</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">get_size_inches</span><span class="p">()</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mf">0.25</span><span class="o">/</span><span class="n">height</span><span class="p">,</span><span class="n">caption_text</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/mAb_outlier_detection_non-recursive_single-pop_12_0.png" src="_images/mAb_outlier_detection_non-recursive_single-pop_12_0.png" />
</div>
</div>
fig,ax = plt.subplots(figsize=(19,3))
new_pop.plot_zscores(ax,rotation='vertical')
t=ax.set_ylabel("Sample logarithmic\nZ score, $Z_{i,k}$",size=15)
ax.axhline(5.1,color='k',ls=':')
for tx in ax.texts:
    tx.set_visible(False)plot_range = ['D2A-S-600',
              'D2A-S-700',
              'D2A-S-800',
              'D2C-S-600',
              'D2C-S-700',
              'D2C-S-800',
             ]

f = mab_project.plot_histograms(jeffries,plot_range=plot_range,#['D2A-S-600','D2C-S-600'],
                                numcols=2)


empirical_red_patch = mpatches.Patch(color='red', label='Empirical distribution')
lognormal_line = mlines.Line2D([],[],color='k',label='Lognormal Fit')
confidence_limit = mlines.Line2D([],[],color='k',ls=':',label='95 % limit')
l = f.axes[0].legend(handles=[empirical_red_patch,lognormal_line,confidence_limit],
                     ncol=3,loc=(0.0,1.1))

caption_text = ('Histograms of the average diameter distances in each experimental group ' +
                'plotted with the corresponding lognormal distribution. \nThe 95% ' +
                'confidence boundary is shown as a vertical dashed line. '
               )

width,height = f.get_size_inches()

t = f.text(0,-0.25/height,caption_text,size=12,va='top')<div class="section" id="Save-outlier-information-to-metadata-table">
<h3>Save outlier information to metadata table<a class="headerlink" href="#Save-outlier-information-to-metadata-table" title="Permalink to this headline">¶</a></h3>
<p>Outlier data from the interlab study is saved to our metadata table.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">metadata_table</span><span class="o">.</span><span class="n">Zscore</span> <span class="o">=</span> <span class="n">new_pop</span><span class="o">.</span><span class="n">zscores</span>
<span class="n">metadata_table</span><span class="o">.</span><span class="n">Outlier</span> <span class="o">=</span> <span class="o">~</span><span class="n">new_pop</span><span class="o">.</span><span class="n">outlier_mask</span>
<span class="n">metadata_table</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>INDEX</th>
      <th>DIR_NAME</th>
      <th>CODE</th>
      <th>TITLE</th>
      <th>ExpType</th>
      <th>ExpCode</th>
      <th>File</th>
      <th>ExptScore</th>
      <th>Zscore</th>
      <th>Outlier</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>8822</td>
      <td>8822-010</td>
      <td>D2C-S-U-900-8822-010-37C</td>
      <td>800</td>
      <td>D2C-S</td>
      <td>./release3/new_ext/001-D2C-S-U-900-8822-010-37...</td>
      <td>0</td>
      <td>0.715926</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>7425</td>
      <td>7425-010</td>
      <td>D2A-S-U-900-7425-010-37C</td>
      <td>800</td>
      <td>D2A-S</td>
      <td>./release3/new_ext/002-D2A-S-U-900-7425-010-37...</td>
      <td>0</td>
      <td>0.670746</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>7425</td>
      <td>7425-012</td>
      <td>D2C-S-U-900-7425-012-37C</td>
      <td>800</td>
      <td>D2C-S</td>
      <td>./release3/new_ext/003-D2C-S-U-900-7425-012-37...</td>
      <td>0</td>
      <td>0.586484</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>7425</td>
      <td>7425-015</td>
      <td>D3A-F-U-900-7425-015-37C</td>
      <td>800</td>
      <td>D3A-F</td>
      <td>./release3/new_ext/004-D3A-F-U-900-7425-015-37...</td>
      <td>0</td>
      <td>0.507501</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>8495</td>
      <td>8495-010</td>
      <td>D2A-S-U-900-8495-010-37C</td>
      <td>800</td>
      <td>D2A-S</td>
      <td>./release3/new_ext/005-D2A-S-U-900-8495-010-37...</td>
      <td>0</td>
      <td>1.115246</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
</div>
<div class="section" id="Outlier-spectra">
<h2>Outlier spectra<a class="headerlink" href="#Outlier-spectra" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plot_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;$^1$H shift (ppm)&#39;</span><span class="p">,</span>
                 <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;$^</span><span class="si">{13}</span><span class="s1">$C shift (ppm)&#39;</span><span class="p">,</span>
                 <span class="n">plot_corners</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.9</span><span class="p">,</span><span class="o">-</span><span class="mf">0.9</span><span class="p">,</span><span class="mf">30.5</span><span class="p">,</span><span class="mi">9</span><span class="p">],</span>
                 <span class="n">shape</span><span class="o">=</span><span class="n">windowed_shape</span><span class="p">,</span>
                 <span class="n">window</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">plotsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">gridspec_kw</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.05</span><span class="p">))</span>

<span class="n">contour_colors_mappable</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span>
    <span class="n">cmap</span><span class="o">=</span><span class="n">mab_utils</span><span class="o">.</span><span class="n">seismic_with_alpha</span><span class="o">.</span><span class="n">reversed</span><span class="p">())</span>

<span class="n">contour_colormap</span> <span class="o">=</span> <span class="n">contour_colors_mappable</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">()</span>
<span class="n">contours_rescale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">ssi_contours</span><span class="p">,</span><span class="o">*</span><span class="n">interp_map</span><span class="p">)</span>

<span class="n">contour_colors</span> <span class="o">=</span> <span class="n">contour_colormap</span><span class="p">(</span><span class="n">contours_rescale</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="False-positive-outliers">
<h3>False-positive outliers<a class="headerlink" href="#False-positive-outliers" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">match_code</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">code</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">code</span> <span class="ow">in</span> <span class="n">metadata_table</span><span class="o">.</span><span class="n">ExpCode</span><span class="o">.</span><span class="n">values</span><span class="p">])</span>
<span class="n">match_expert</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">score</span><span class="o">==</span><span class="mi">0</span> <span class="k">for</span> <span class="n">score</span> <span class="ow">in</span> <span class="n">metadata_table</span><span class="o">.</span><span class="n">ExptScore</span><span class="o">.</span><span class="n">values</span><span class="p">])</span>
<span class="n">match_algori</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">metadata_table</span><span class="o">.</span><span class="n">Outlier</span><span class="p">)</span>
<span class="n">match_outlier</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">match_expert</span><span class="p">,</span><span class="n">match_algori</span><span class="p">)</span>
<span class="c1">#match_outlier =  np.logical_or(np.array(metadata_table.Outlier),np.array(metadata_table.LabOutlier))</span>
<span class="n">match</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">match_outlier</span><span class="p">,</span><span class="n">match_code</span><span class="p">)</span>
<span class="n">bbox</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>

<span class="n">exps</span> <span class="o">=</span> <span class="n">metadata_table</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">match</span><span class="p">]</span>
<span class="n">fig</span><span class="p">,</span><span class="n">axes</span> <span class="o">=</span> <span class="n">mab_utils</span><span class="o">.</span><span class="n">plot_the_nmr</span><span class="p">(</span><span class="n">exps</span><span class="p">,</span><span class="n">ncols</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                                  <span class="n">levels</span><span class="o">=</span><span class="n">ssi_contours</span><span class="p">,</span>
                                  <span class="n">color</span><span class="o">=</span><span class="n">contour_colors</span><span class="p">,</span>
                                  <span class="o">**</span><span class="n">plot_dict</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">invert_xaxis</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="k">for</span> <span class="n">score</span><span class="p">,</span><span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">metadata_table</span><span class="o">.</span><span class="n">ExptScore</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">match</span><span class="p">],</span><span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.95</span><span class="p">,</span><span class="mf">0.95</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">score</span><span class="p">),</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span><span class="n">bbox</span><span class="o">=</span><span class="n">bbox</span><span class="p">)</span>

<span class="n">caption_text</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Contour plots of the NMR spectra identified as outliers by the algorithm &#39;</span> <span class="o">+</span>
                <span class="s1">&#39;but not by the expert, annotated with their Z-scores and expert scores.&#39;</span>
               <span class="p">)</span>
<span class="n">width</span><span class="p">,</span><span class="n">height</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">get_size_inches</span><span class="p">()</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mf">0.25</span><span class="o">/</span><span class="n">height</span><span class="p">,</span><span class="n">caption_text</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/local/NIST/dsheen/.conda/envs/default_outside/lib/python3.7/site-packages/matplotlib/contour.py:1000: UserWarning: The following kwargs were not used by contour: &#39;aspect&#39;
  s)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/mAb_outlier_detection_non-recursive_single-pop_20_1.png" src="_images/mAb_outlier_detection_non-recursive_single-pop_20_1.png" />
</div>
</div>
</div>
<div class="section" id="Expert-level-2-outliers">
<h3>Expert level-2 outliers<a class="headerlink" href="#Expert-level-2-outliers" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">match_code</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">code</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">code</span> <span class="ow">in</span> <span class="n">metadata_table</span><span class="o">.</span><span class="n">ExpCode</span><span class="o">.</span><span class="n">values</span><span class="p">])</span>
<span class="n">match_outlier</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">score</span><span class="o">&gt;</span><span class="mi">1</span> <span class="k">for</span> <span class="n">score</span> <span class="ow">in</span> <span class="n">metadata_table</span><span class="o">.</span><span class="n">ExptScore</span><span class="o">.</span><span class="n">values</span><span class="p">])</span>
<span class="c1">#match_outlier =  np.logical_or(np.array(metadata_table.Outlier),np.array(metadata_table.LabOutlier))</span>
<span class="n">match</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">match_outlier</span><span class="p">,</span><span class="n">match_code</span><span class="p">)</span>
<span class="n">bbox</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>

<span class="n">exps</span> <span class="o">=</span> <span class="n">metadata_table</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">match</span><span class="p">]</span>
<span class="n">fig</span><span class="p">,</span><span class="n">axes</span> <span class="o">=</span> <span class="n">mab_utils</span><span class="o">.</span><span class="n">plot_the_nmr</span><span class="p">(</span><span class="n">exps</span><span class="p">,</span><span class="n">ncols</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                                  <span class="n">levels</span><span class="o">=</span><span class="n">ssi_contours</span><span class="p">,</span>
                                  <span class="n">color</span><span class="o">=</span><span class="n">contour_colors</span><span class="p">,</span>
                                  <span class="o">**</span><span class="n">plot_dict</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">invert_xaxis</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="k">for</span> <span class="n">score</span><span class="p">,</span><span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">metadata_table</span><span class="o">.</span><span class="n">ExptScore</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">match</span><span class="p">],</span><span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.95</span><span class="p">,</span><span class="mf">0.95</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">score</span><span class="p">),</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span><span class="n">bbox</span><span class="o">=</span><span class="n">bbox</span><span class="p">)</span>

<span class="n">caption_text</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Contour plots of the NMR spectra identified as outliers by the expert &#39;</span> <span class="o">+</span>
                <span class="s1">&#39;annotated with their Z-scores and expert scores.&#39;</span>
               <span class="p">)</span>
<span class="n">width</span><span class="p">,</span><span class="n">height</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">get_size_inches</span><span class="p">()</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mf">0.25</span><span class="o">/</span><span class="n">height</span><span class="p">,</span><span class="n">caption_text</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/mAb_outlier_detection_non-recursive_single-pop_22_0.png" src="_images/mAb_outlier_detection_non-recursive_single-pop_22_0.png" />
</div>
</div>
</div>
<div class="section" id="Expert-level-1-outliers">
<h3>Expert level-1 outliers<a class="headerlink" href="#Expert-level-1-outliers" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">match_code</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">code</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">code</span> <span class="ow">in</span> <span class="n">metadata_table</span><span class="o">.</span><span class="n">ExpCode</span><span class="o">.</span><span class="n">values</span><span class="p">])</span>
<span class="n">match_outlier</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">score</span><span class="o">==</span><span class="mi">1</span> <span class="k">for</span> <span class="n">score</span> <span class="ow">in</span> <span class="n">metadata_table</span><span class="o">.</span><span class="n">ExptScore</span><span class="o">.</span><span class="n">values</span><span class="p">])</span>
<span class="c1">#match_outlier =  np.logical_or(np.array(metadata_table.Outlier),np.array(metadata_table.LabOutlier))</span>
<span class="n">match</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">match_outlier</span><span class="p">,</span><span class="n">match_code</span><span class="p">)</span>
<span class="n">bbox</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>

<span class="n">exps</span> <span class="o">=</span> <span class="n">metadata_table</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">match</span><span class="p">]</span>
<span class="n">fig</span><span class="p">,</span><span class="n">axes</span> <span class="o">=</span> <span class="n">mab_utils</span><span class="o">.</span><span class="n">plot_the_nmr</span><span class="p">(</span><span class="n">exps</span><span class="p">,</span><span class="n">ncols</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                                  <span class="n">levels</span><span class="o">=</span><span class="n">ssi_contours</span><span class="p">,</span>
                                  <span class="n">color</span><span class="o">=</span><span class="n">contour_colors</span><span class="p">,</span>
                                  <span class="o">**</span><span class="n">plot_dict</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">invert_xaxis</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="k">for</span> <span class="n">score</span><span class="p">,</span><span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">metadata_table</span><span class="o">.</span><span class="n">ExptScore</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">match</span><span class="p">],</span><span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.95</span><span class="p">,</span><span class="mf">0.95</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">score</span><span class="p">),</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span><span class="n">bbox</span><span class="o">=</span><span class="n">bbox</span><span class="p">)</span>

<span class="n">caption_text</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Contour plots of the NMR spectra identified as level-1 outliers by &#39;</span> <span class="o">+</span>
                <span class="s1">&#39;the expert, annotated with their Z-scores and expert scores.&#39;</span>
               <span class="p">)</span>

<span class="n">width</span><span class="p">,</span><span class="n">height</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">get_size_inches</span><span class="p">()</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mf">0.25</span><span class="o">/</span><span class="n">height</span><span class="p">,</span><span class="n">caption_text</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/mAb_outlier_detection_non-recursive_single-pop_24_0.png" src="_images/mAb_outlier_detection_non-recursive_single-pop_24_0.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">metadata_table</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;metadata_table_single-pop.csv&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>Table of Contents</h3>
          <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Project.html">The interlab Project class</a></li>
<li class="toctree-l1"><a class="reference internal" href="Subobjects.html">Subobjects within the Project class</a></li>
<li class="toctree-l1"><a class="reference internal" href="Metrics.html">Distance metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="analysis_demo.html">Example interlaboratory study</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="nist_mab.html">Chemometric Outlier Detection and Classification of 2D-NMR Spectra</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="nist_mab.html#contents">Contents</a></li>
</ul>
</li>
</ul>

          <div role="search">
            <h3 style="margin-top: 1.5em;">Search</h3>
            <form class="search" action="search.html" method="get">
                <input type="text" name="q" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
            </form>
          </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <div role="navigation" aria-label="related navigaton">
            <a href="mAb_outlier_detection_recursive.html" title="Outlier Detection: Recursive"
              >previous</a> |
            <a href="genindex.html" title="General Index"
              >index</a>
          </div>
          <div role="note" aria-label="source link">
              <br/>
              <a href="_sources/mAb_outlier_detection_non-recursive_single-pop.ipynb.txt"
                rel="nofollow">Show Source</a>
          </div>
        </div>

        <div class="right">
          
    <div class="footer" role="contentinfo">
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>